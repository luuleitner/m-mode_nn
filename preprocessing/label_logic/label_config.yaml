# ==================================================
# LABEL EXTRACTION CONFIGURATION
# ==================================================
# Single source of truth for all labeling parameters.
# Used by: processor.py, training scripts, visualization, evaluation

# --------------------------------------------------
# CLASS DEFINITIONS (single source of truth)
# --------------------------------------------------
classes:
  num_classes: 5              # Total number of classes (3 for single-axis, 5 for dual)
  noise_class: 0              # Index of noise/neutral class

  # Class name mapping (used in visualizations, metrics, reports)
  names:
    0: "Noise"
    1: "Up"
    2: "Down"
    3: "Left"
    4: "Right"

  # Short names for compact displays
  short_names:
    0: "N"
    1: "U"
    2: "D"
    3: "L"
    4: "R"

  # Colors for visualization (rgba format)
  colors:
    0: "rgba(128, 128, 128, 0.3)"   # Noise - Gray
    1: "rgba(0, 200, 0, 0.4)"       # Up - Green
    2: "rgba(200, 0, 0, 0.4)"       # Down - Red
    3: "rgba(0, 100, 255, 0.4)"     # Left - Blue
    4: "rgba(255, 165, 0, 0.4)"     # Right - Orange

# --------------------------------------------------
# LABELING METHOD & PARAMETERS
# --------------------------------------------------
method: "position_peak"         # position_peak is the only supported method
axis: "dual"                    # x | y | dual

# Axis modes:
#   x:    3-class using X-axis only (0=noise, 1=right, 2=left)
#   y:    3-class using Y-axis only (0=noise, 1=up, 2=down)
#   dual: 5-class using both axes with amplitude voting:
#         0=noise, 1=up, 2=down, 3=left, 4=right

# --------------------------------------------------
# POSITION PEAK METHOD PARAMETERS
# --------------------------------------------------
# Three-phase detection: Start → Peak → Stop
#   Phase 1: |velocity| > deriv_threshold AND |position| < pos_threshold
#   Phase 2: position reverses (peak detected)
#   Phase 3: |velocity| < deriv_threshold
position_peak:
  deriv_threshold_percent: 10.0    # velocity threshold as % of max velocity (lower = wider labels)
  pos_threshold_percent: 5.0      # center zone as % of max position (start must be within this)
  peak_window: 3                  # samples to confirm position reversal (noise filter)
  timeout_samples: 500            # max samples per phase before forcing end

# --------------------------------------------------
# SOFT LABELS (for training)
# --------------------------------------------------
soft_labels:
  enabled: true
  weighting: "gaussian"         # uniform | gaussian
  gaussian_sigma_ratio: 0.25    # sigma = window_size * ratio

# --------------------------------------------------
# JOYSTICK SIGNAL FILTERS
# --------------------------------------------------
# Applied before label extraction to reduce noise and
# improve movement detection accuracy.

filters:
  position:
    lowpass:
      enabled: true
      cutoff: 5             # Hz
      fs: 175               # sampling frequency Hz
      order: 2
      ax: 0
    savitzky_golay:
      enabled: true
      window_length: 51     # must be odd
      polyorder: 2

  derivative:
    moving_average:
      enabled: true
      window_size: 20

# --------------------------------------------------
# VISUALIZATION (for label_logic/visualize.py only)
# --------------------------------------------------
display:
  show_raw_trace: true
